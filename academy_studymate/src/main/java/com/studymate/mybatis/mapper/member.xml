<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
              "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
              
<mapper namespace="com.studymate.member.model.MemberDao">

	<select id="totalcount" resultType="Integer" >
		SELECT count(*) FROM member 
	</select>
	
	<select id="totalcountById"  resultType="Integer">
		SELECT count(*) FROM member WHERE memId LIKE '%'||#{keyWord}||'%'
	</select>

	<select id="totalcountByName" resultType="Integer">
		SELECT count(*) FROM member WHERE memName LIKE '%'||#{keyWord}||'%'
	</select>
	
	<select id="totalcountByEmail" resultType="Integer">
		SELECT count(*) FROM member WHERE memEmail LIKE '%'||#{keyWord}||'%'
	</select>
	
	<select id="totalcountByAddr" resultType="Integer">
		SELECT count(*) FROM member WHERE memAddr LIKE '%'||#{keyWord}||'%' or m_area LIKE '%'||#{keyWord}||'%' 
	</select>
	
	<select id="list" resultType="MemberDto" parameterType="java.util.HashMap">
		SELECT m_id, m_name, m_sex, m_birth, m_addr, m_area, m_email, m_job, m_siteout, m_regdate 
		FROM( SELECT ROWNUM num, m_id, m_name, m_sex, m_birth, m_addr, m_area, m_email, m_job, m_siteout, m_regdate 
			FROM ( SELECT m_id, m_name, m_sex, m_birth, m_addr, m_area, m_email, m_job, m_siteout, m_regdate FROM member
				ORDER BY m_regdate DESC ) ) WHERE num between #{startRow} and #{endRow}
	</select>
	
	<select id="read" resultType="MemberDto"  parameterType="Integer">
		SELECT bon_num, bon_title, bon_content, bon_readcount, bon_regdate FROM notice WHERE bon_num = #{bon_num}
	</select>
	
	<insert id="write"  parameterType="MemberDto">
		INSERT INTO notice VALUES (	bon_num.nextval, #{bon_title}, #{bon_content}, 0, sysdate)
	</insert>
	
	<update id="update" parameterType="MemberDto">
		UPDATE notice SET bon_title = #{bon_title}, bon_content = #{bon_content} WHERE bon_num = #{bon_num}  
	</update>
	
	<update id="updateReadCount" parameterType="Integer">
		UPDATE notice SET bon_readcount = bon_readcount+1 WHERE bon_num = #{bon_num} 
	</update>
	
	<delete id="delete" parameterType="Integer">
		DELETE FROM notice WHERE bon_num = #{bon_num} 
	</delete>
	
</mapper>
